!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Accessify={})}(this,function(e){"use strict";const t="accessify-settings",n=Object.freeze({textSize:100,contrastMode:"normal",textSpacing:"normal",fontType:"default",highlightLinks:!1,highlightCursor:!1,language:"en",colorFilter:"none"});function o(e){try{localStorage.setItem(t,JSON.stringify(e))}catch(e){}}const i="accessify-toolbar-v2-styles";function s(){if(document.getElementById(i))return;const e=document.createElement("style");e.id=i,e.textContent='\n/* ---- Toolbar V2: Trigger (bottom; left for RTL/hebrew, right for LTR/english) ---- */\n.accessify-toolbar-v2-trigger {\n  position: fixed;\n  bottom: 1rem;\n  inset-inline-end: 1rem;\n  z-index: 10002;\n  width: 48px;\n  height: 48px;\n  min-width: 48px;\n  min-height: 48px;\n  padding: 12px;\n  border: none;\n  border-radius: 50%;\n  background-color: #2563eb;\n  color: #fff;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.35);\n  transition: transform 0.3s ease, box-shadow 0.2s ease, background-color 0.2s ease;\n}\n.accessify-toolbar-v2-trigger[aria-expanded="false"] {\n  transform: rotate(180deg);\n}\n.accessify-toolbar-v2-trigger[aria-expanded="true"] {\n  transform: rotate(0deg);\n}\n.accessify-toolbar-v2-trigger:hover {\n  background-color: #1d4ed8;\n}\n.accessify-toolbar-v2-trigger:focus {\n  outline: none;\n}\n.accessify-toolbar-v2-trigger:focus-visible {\n  outline: none;\n  box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.5);\n}\n.accessify-toolbar-v2-trigger .accessify-toolbar-v2-icon,\n.accessify-toolbar-v2-trigger .accessify-toolbar-v2-trigger-icon-img {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.accessify-toolbar-v2-trigger .accessify-toolbar-v2-trigger-icon-img {\n  width: 24px;\n  height: 24px;\n  object-fit: contain;\n}\n.accessify-toolbar-v2-trigger .accessify-toolbar-v2-icon svg {\n  width: 24px;\n  height: 24px;\n}\n.accessify-toolbar-v2-trigger .accessify-toolbar-v2-trigger-fallback {\n  display: none;\n}\n.accessify-toolbar-v2-trigger:not(:has(.accessify-toolbar-v2-trigger-icon-img)) .accessify-toolbar-v2-trigger-fallback {\n  display: flex;\n}\n\n/* ---- Toolbar V2: Panel (bottom, same side as trigger; dir set in JS for inset-inline-end) ---- */\n.accessify-toolbar-v2-panel {\n  position: fixed;\n  bottom: 5rem;\n  inset-inline-end: 1rem;\n  z-index: 10001;\n  width: 260px;\n  max-width: calc(100vw - 2rem);\n  max-height: calc(100vh - 7rem);\n  background: #fff;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.accessify-toolbar-v2-panel-body {\n  padding: 16px 8px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n/* ---- Toolbar V2: Header ---- */\n.accessify-toolbar-v2-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 8px;\n  background-color: #eff6ff;\n  border-bottom: 2px solid #e5e7eb;\n}\n.accessify-toolbar-v2-header-title {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: #111827;\n}\n.accessify-toolbar-v2-header-title .accessify-toolbar-v2-header-title-icon {\n  display: flex;\n  align-items: center;\n  flex-shrink: 0;\n}\n.accessify-toolbar-v2-header-title .accessify-toolbar-v2-header-title-icon-img {\n  width: 20px;\n  height: 20px;\n  object-fit: contain;\n}\n.accessify-toolbar-v2-header-title .accessify-toolbar-v2-header-title-icon-fallback {\n  display: none;\n  color: #2563eb;\n}\n.accessify-toolbar-v2-header-title .accessify-toolbar-v2-header-title-icon-fallback svg {\n  width: 20px;\n  height: 20px;\n}\n.accessify-toolbar-v2-header-title .accessify-toolbar-v2-header-title-icon:not(:has(.accessify-toolbar-v2-header-title-icon-img)) .accessify-toolbar-v2-header-title-icon-fallback {\n  display: flex;\n}\n.accessify-toolbar-v2-close {\n  width: 44px;\n  height: 44px;\n  min-width: 44px;\n  min-height: 44px;\n  padding: 0;\n  border: none;\n  border-radius: 6px;\n  background: transparent;\n  color: #6b7280;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.accessify-toolbar-v2-close:hover {\n  color: #374151;\n  background: rgba(0, 0, 0, 0.05);\n}\n.accessify-toolbar-v2-close:focus {\n  outline: none;\n}\n.accessify-toolbar-v2-close:focus-visible {\n  outline: none;\n  box-shadow: 0 0 0 2px #2563eb;\n}\n.accessify-toolbar-v2-close .accessify-toolbar-v2-icon svg {\n  width: 20px;\n  height: 20px;\n}\n\n/* ---- Toolbar V2: Section ---- */\n.accessify-toolbar-v2-section {\n  margin-bottom: 16px;\n}\n.accessify-toolbar-v2-section:last-child {\n  margin-bottom: 0;\n}\n.accessify-toolbar-v2-section-label {\n  display: block;\n  margin-bottom: 8px;\n  font-size: 0.6875rem;\n  font-weight: 600;\n  color: #4b5563;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n.accessify-toolbar-v2-section-controls {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  width: 100%;\n}\n.accessify-toolbar-v2-section-controls > .accessify-toolbar-v2-btn,\n.accessify-toolbar-v2-section-controls > div {\n  flex: 1;\n  min-width: 0;\n}\n\n/* ---- Toolbar V2: Customize (show/hide tools, collapsible) ---- */\n.accessify-toolbar-v2-customize {\n  margin-bottom: 16px;\n}\n.accessify-toolbar-v2-customize-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  min-height: 48px;\n  padding: 12px 16px;\n  border: 2px solid #d1d5db;\n  border-radius: 8px;\n  background: #fff;\n  color: #111827;\n  font-size: 0.6875rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n  color: #4b5563;\n  cursor: pointer;\n  transition: border-color 0.15s ease, background-color 0.15s ease;\n}\n.accessify-toolbar-v2-customize-header:hover {\n  border-color: #2563eb;\n  background: #eff6ff;\n}\n.accessify-toolbar-v2-customize-header:focus-visible {\n  outline: 2px solid #2563eb;\n  outline-offset: 2px;\n}\n.accessify-toolbar-v2-customize-header-label {\n  flex: 1;\n  text-align: left;\n}\n.accessify-toolbar-v2-customize-chevron {\n  flex-shrink: 0;\n  transition: transform 0.2s ease;\n}\n.accessify-toolbar-v2-customize-open .accessify-toolbar-v2-customize-chevron {\n  transform: rotate(180deg);\n}\n.accessify-toolbar-v2-customize-body {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10px 16px;\n  margin-top: 12px;\n  padding: 0 2px;\n}\n.accessify-toolbar-v2-customize-body[hidden] {\n  display: none;\n}\n.accessify-toolbar-v2-customize-label {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: #374151;\n}\n.accessify-toolbar-v2-customize-checkbox {\n  width: 18px;\n  height: 18px;\n  accent-color: #2563eb;\n  cursor: pointer;\n}\n.accessify-toolbar-v2-customize-label-text {\n  user-select: none;\n}\n.accessify-toolbar-v2-section[data-control-id] {\n  transition: opacity 0.15s ease;\n}\n\n/* ---- Toolbar V2: Buttons (default) ---- */\n.accessify-toolbar-v2-btn {\n  min-height: 48px;\n  padding: 14px 16px;\n  border: 2px solid #d1d5db;\n  border-radius: 8px;\n  background: #fff;\n  color: #111827;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: border-color 0.15s ease, background-color 0.15s ease, color 0.15s ease;\n}\n.accessify-toolbar-v2-btn:hover:not(:disabled) {\n  border-color: #2563eb;\n  background-color: #eff6ff;\n}\n.accessify-toolbar-v2-btn:focus {\n  outline: none;\n}\n.accessify-toolbar-v2-btn:focus-visible {\n  outline: none;\n  box-shadow: 0 0 0 2px #2563eb;\n}\n.accessify-toolbar-v2-btn:disabled {\n  border-color: #e5e7eb;\n  background-color: #f9fafb;\n  color: #9ca3af;\n  cursor: not-allowed;\n}\n.accessify-toolbar-v2-btn[aria-pressed="true"] {\n  border-color: #2563eb;\n  background-color: #eff6ff;\n  color: #1d4ed8;\n}\n.accessify-toolbar-v2-btn .accessify-toolbar-v2-icon {\n  display: flex;\n  flex-shrink: 0;\n}\n.accessify-toolbar-v2-btn .accessify-toolbar-v2-icon svg {\n  width: 20px;\n  height: 20px;\n}\n\n/* Text size value display */\n.accessify-toolbar-v2-value {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: #2563eb;\n  min-width: 3ch;\n  text-align: center;\n}\n\n/* Font D badge */\n.accessify-toolbar-v2-font-d-badge {\n  width: 24px;\n  height: 24px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  background: #111827;\n  color: #fff;\n  font-size: 0.875rem;\n  font-weight: 700;\n  border-radius: 4px;\n  flex-shrink: 0;\n}\n\n/* Language buttons */\n.accessify-toolbar-v2-language-buttons {\n  display: flex;\n  gap: 8px;\n  width: 100%;\n}\n.accessify-toolbar-v2-language-btn {\n  flex: 1;\n  min-width: 0;\n}\n\n/* Reset button */\n.accessify-toolbar-v2-reset {\n  margin-top: 8px;\n  padding-top: 16px;\n  border-top: 2px solid #e5e7eb;\n}\n.accessify-toolbar-v2-reset .accessify-toolbar-v2-btn {\n  width: 100%;\n  background: #fef2f2;\n  border-color: #fca5a5;\n  color: #b91c1c;\n}\n.accessify-toolbar-v2-reset .accessify-toolbar-v2-btn:hover {\n  background: #fee2e2;\n  border-color: #f87171;\n}\n.accessify-toolbar-v2-reset .accessify-toolbar-v2-btn:focus-visible {\n  box-shadow: 0 0 0 2px #ef4444;\n}\n\n/* Cursor highlight circle (centered on pointer) - above toolbar so it stays visible */\n.accessify-toolbar-v2-cursor-circle {\n  position: fixed;\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  border: 4px solid #2563eb;\n  background: rgba(37, 99, 235, 0.1);\n  pointer-events: none;\n  z-index: 10003;\n  left: 0;\n  top: 0;\n  transform: translate(-50%, -50%);\n}\n\n/* Visually hidden live region for screen reader announcements */\n.accessify-toolbar-v2-live {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border: 0;\n}\n\n/* Reduced motion */\n@media (prefers-reduced-motion: reduce) {\n  .accessify-toolbar-v2-trigger,\n  .accessify-toolbar-v2-btn,\n  .accessify-toolbar-v2-close {\n    transition: none;\n  }\n  .accessify-toolbar-v2-cursor-circle {\n    transition: none;\n  }\n}\n\n/* ---- Body/Root accessibility classes (page effects) ---- */\n/* Contrast applied to content wrapper (not body) so filter does not break toolbar position:fixed */\n.contrast-normal {\n  /* default */\n}\n.contrast-high {\n  filter: contrast(150%) brightness(1.1);\n}\n.contrast-high *:not(button):not(a) {\n  border-color: #000 !important;\n}\n.contrast-high button,\n.contrast-high a {\n  border: 2px solid currentColor !important;\n}\n.contrast-high {\n  font-weight: 500;\n}\n.contrast-high h1, .contrast-high h2, .contrast-high h3,\n.contrast-high h4, .contrast-high h5, .contrast-high h6 {\n  font-weight: 700;\n}\n.contrast-dark {\n  background-color: #1a1a1a !important;\n  color: #e5e7eb !important;\n  min-height: 100vh;\n}\n.contrast-dark a {\n  color: #93c5fd !important;\n}\n.text-spacing-wide p,\n.text-spacing-wide h1, .text-spacing-wide h2, .text-spacing-wide h3,\n.text-spacing-wide h4, .text-spacing-wide h5, .text-spacing-wide h6,\n.text-spacing-wide li, .text-spacing-wide span, .text-spacing-wide div {\n  line-height: 2 !important;\n  letter-spacing: 0.12em !important;\n  word-spacing: 0.16em !important;\n}\n.text-spacing-wide button,\n.text-spacing-wide a {\n  padding-top: 0.75em !important;\n  padding-bottom: 0.75em !important;\n}\n.font-dyslexia,\n.font-dyslexia * {\n  font-family: \'Comic Sans MS\', \'OpenDyslexic\', Arial, sans-serif !important;\n}\n.highlight-links a {\n  text-decoration: underline !important;\n  text-decoration-thickness: 2px !important;\n  text-underline-offset: 3px !important;\n  font-weight: 600 !important;\n  background-color: rgba(255, 255, 0, 0.2) !important;\n  padding: 2px 4px !important;\n  border-radius: 2px !important;\n}\n.highlight-links a:hover {\n  background-color: rgba(255, 255, 0, 0.4) !important;\n}\n.highlight-cursor,\n.highlight-cursor * {\n  cursor: none !important;\n}\n\n/* Color adjustments (applied to content wrapper) */\n.color-filter-none {\n  /* default */\n}\n.color-filter-grayscale,\n.color-filter-grayscale * {\n  filter: grayscale(100%) !important;\n}\n.color-filter-invert,\n.color-filter-invert * {\n  filter: invert(100%) !important;\n}\n',document.head.appendChild(e)}const r={en:{triggerAriaLabel:"Toggle Accessibility Controls",triggerTitle:"Open accessibility controls",headerTitle:"Accessibility",closeAriaLabel:"Close",closeTitle:"Close panel",customizeHeader:"Show or hide tools",showControl:"Show {label}",sectionTextSize:"Text size",sectionContrast:"Contrast",sectionSpacing:"Spacing",sectionFont:"Font",sectionLinks:"Links",sectionCursor:"Cursor",sectionReset:"Reset",sectionLanguage:"Language",sectionColorAdjustments:"Color Adjustments",controlTextSize:"Text size",controlContrast:"Contrast",controlSpacing:"Spacing",controlFont:"Font",controlLinks:"Links",controlCursor:"Cursor",controlReset:"Reset",controlLanguage:"Language",controlColorAdjustments:"Color Adjustments",decreaseTextSize:"Decrease text size",increaseTextSize:"Increase text size",toggleContrast:"Toggle contrast mode",contrastTitle:"Change contrast (Normal / High / Dark)",contrastNormal:"Normal",contrastHigh:"High",contrastDark:"Dark",contrastAriaLabelCurrent:"Contrast: {mode}",announceContrast:"Contrast set to {mode}",toggleSpacing:"Toggle text spacing",spacingTitle:"Toggle letter and line spacing",spacingNormal:"Normal",spacingWide:"Wide",announceSpacing:"Text spacing {state}",toggleFont:"Toggle dyslexia-friendly font",fontTitle:"Switch to dyslexia-friendly font",fontDefault:"Default",fontDyslexia:"Dyslexia",announceFont:"Dyslexia-friendly font {state}",toggleLinks:"Toggle link highlighting",linksTitle:"Highlight links on the page",on:"ON",off:"OFF",announceLinks:"Link highlighting {state}",toggleCursor:"Toggle cursor highlighting",cursorTitle:"Highlight cursor with a circle",announceCursor:"Cursor highlighting {state}",resetAriaLabel:"Reset all settings",resetTitle:"Restore all settings to default",resetLabel:"Reset",announceReset:"All settings reset",languageEn:"English",languageHe:"עברית",colorAdjustmentsTitle:"Change color filter (for color vision)",colorFilterNone:"None",colorFilterGrayscale:"Grayscale",colorFilterInvert:"Invert",colorFilterAriaLabelCurrent:"Color filter: {mode}",announceColorFilter:"Color filter set to {mode}"},he:{triggerAriaLabel:"הצג/הסתר פקדי נגישות",triggerTitle:"פתח פקדי נגישות",headerTitle:"נגישות",closeAriaLabel:"סגור",closeTitle:"סגור חלונית",customizeHeader:"הצג או הסתר כלים",showControl:"הצג {label}",sectionTextSize:"גודל טקסט",sectionContrast:"ניגודיות",sectionSpacing:"ריווח",sectionFont:"גופן",sectionLinks:"קישורים",sectionCursor:"סמן",sectionReset:"איפוס",sectionLanguage:"שפה",sectionColorAdjustments:"התאמות צבע",controlTextSize:"גודל טקסט",controlContrast:"ניגודיות",controlSpacing:"ריווח",controlFont:"גופן",controlLinks:"קישורים",controlCursor:"סמן",controlReset:"איפוס",controlLanguage:"שפה",controlColorAdjustments:"התאמות צבע",decreaseTextSize:"הקטן גודל טקסט",increaseTextSize:"הגדל גודל טקסט",toggleContrast:"החלף מצב ניגודיות",contrastTitle:"שינוי ניגודיות (רגיל / גבוה / כהה)",contrastNormal:"רגיל",contrastHigh:"גבוה",contrastDark:"כהה",contrastAriaLabelCurrent:"ניגודיות: {mode}",announceContrast:"ניגודיות הוגדרה ל-{mode}",toggleSpacing:"החלף ריווח טקסט",spacingTitle:"החלף ריווח אותיות ושורות",spacingNormal:"רגיל",spacingWide:"רחב",announceSpacing:"ריווח טקסט {state}",toggleFont:"החלף גופן ידידותי לדיסלקציה",fontTitle:"החלף לגופן ידידותי לדיסלקציה",fontDefault:"ברירת מחדל",fontDyslexia:"דיסלקציה",announceFont:"גופן ידידותי לדיסלקציה {state}",toggleLinks:"החלף הדגשת קישורים",linksTitle:"הדגש קישורים בעמוד",on:"פועל",off:"כבוי",announceLinks:"הדגשת קישורים {state}",toggleCursor:"החלף הדגשת סמן",cursorTitle:"הדגש סמן עם עיגול",announceCursor:"הדגשת סמן {state}",resetAriaLabel:"אפס את כל ההגדרות",resetTitle:"שחזר את כל ההגדרות לברירת מחדל",resetLabel:"איפוס",announceReset:"כל ההגדרות אופסו",languageEn:"English",languageHe:"עברית",colorAdjustmentsTitle:"שינוי מסנן צבע (למען ראיית צבע)",colorFilterNone:"ללא",colorFilterGrayscale:"גווני אפור",colorFilterInvert:"היפוך",colorFilterAriaLabelCurrent:"מסנן צבע: {mode}",announceColorFilter:"מסנן צבע הוגדר ל-{mode}"}},a="en";let l=a;const c=[];function d(e,t){const n=r[l]||r[a];let o=n&&n[e]||r[a]&&r[a][e]||e;return t&&Object.keys(t).forEach(e=>{o=o.replace(new RegExp("\\{"+e+"\\}","g"),t[e])}),o}function h(){return l}function u(e){r[e]&&(l=e,c.forEach(e=>e()))}function g(){return Object.keys(r)}function p(e){if(!e||"string"!=typeof e)return null;const t=e.trim().toLowerCase(),n=t.split("-")[0],o=g();if(o.includes(t))return t;if(o.includes(n))return n;const i={en:"en",he:"he"};return i[n]&&o.includes(i[n])?i[n]:null}function b(e){return"he"===e?"rtl":"ltr"}class f{constructor(){this.el=null,this.raf=null,this.x=0,this.y=0}mount(){this.el||(this.el=document.createElement("div"),this.el.className="accessify-toolbar-v2-cursor-circle",this.el.setAttribute("aria-hidden","true"),document.body.appendChild(this.el),this._boundMove=this._onMove.bind(this),window.addEventListener("mousemove",this._boundMove,{passive:!0}))}unmount(){this.el&&(window.removeEventListener("mousemove",this._boundMove),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=null,this.raf&&cancelAnimationFrame(this.raf))}setVisible(e){this.el&&(this.el.style.display=e?"block":"none")}_onMove(e){this.x=e.clientX,this.y=e.clientY,this.raf||(this.raf=requestAnimationFrame(()=>{this.raf=null,this.el&&(this.el.style.left=this.x+"px",this.el.style.top=this.y+"px")}))}}const m=' width="20" height="20" ',y=' width="24" height="24" ',v={accessibility:`<svg xmlns="http://www.w3.org/2000/svg" ${y} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="4" r="2"/><path d="m15 22 2-6 2 6"/><path d="m7 22-2-6-2 6"/><path d="M12 6v14"/><path d="M8 14h8"/></svg>`,typeSmall:'<svg xmlns="http://www.w3.org/2000/svg"  width="16" height="16"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" y1="20" x2="15" y2="20"/><line x1="12" y1="4" x2="12" y2="20"/></svg>',typeLarge:`<svg xmlns="http://www.w3.org/2000/svg" ${y} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" y1="20" x2="15" y2="20"/><line x1="12" y1="4" x2="12" y2="20"/></svg>`,sun:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>`,contrast:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10"/><path d="M12 2a10 10 0 0 1 0 20"/></svg>`,moon:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>`,alignJustify:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>`,link:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>`,mousePointer:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3Z"/></svg>`,rotateCcw:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>`,x:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>`,chevronDown:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="m6 9 6 6 6-6"/></svg>`,palette:`<svg xmlns="http://www.w3.org/2000/svg" ${m} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.9 0 1.75-.2 2.5-.5"/></svg>`};function x(e,t=""){const n=document.createElement("span");return n.className="accessify-toolbar-v2-icon"+(t?" "+t:""),n.innerHTML=e,n.setAttribute("aria-hidden","true"),n}function C(e){const t=document.createElement("div");t.className="accessify-toolbar-v2-header";const n=document.createElement("div");n.className="accessify-toolbar-v2-header-title",n.appendChild(function(){const e=document.createElement("span");e.className="accessify-toolbar-v2-header-title-icon";const t=document.createElement("img");t.src="assets/accessify-icon.png",t.alt="",t.className="accessify-toolbar-v2-header-title-icon-img",t.setAttribute("aria-hidden","true");const n=x(v.accessibility);return n.classList.add("accessify-toolbar-v2-header-title-icon-fallback"),t.onerror=()=>{t.parentNode===e&&e.removeChild(t)},e.appendChild(t),e.appendChild(n),e}());const o=document.createElement("h2");o.className="accessify-toolbar-v2-header-title-text",o.setAttribute("data-i18n-key","headerTitle"),o.textContent=d("headerTitle"),n.appendChild(o),t.appendChild(n);const i=document.createElement("button");return i.type="button",i.className="accessify-toolbar-v2-close",i.setAttribute("aria-label",d("closeAriaLabel")),i.title=d("closeTitle"),i.appendChild(x(v.x)),i.addEventListener("click",e),t.appendChild(i),{element:t,refreshLabels(){const e=t.querySelector(".accessify-toolbar-v2-header-title-text");e&&(e.textContent=d("headerTitle")),i.setAttribute("aria-label",d("closeAriaLabel")),i.title=d("closeTitle")}}}function w(e,t){const n=document.createElement("div");n.className="accessify-toolbar-v2-section";const o=document.createElement("span");o.className="accessify-toolbar-v2-section-label",o.setAttribute("data-section-label-key",e),o.textContent=d(e),o.id="accessify-toolbar-v2-label-"+e.replace(/\s+/g,"-").toLowerCase();const i=document.createElement("div");i.className="accessify-toolbar-v2-section-controls";return(Array.isArray(t)?t:[t]).forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&i.appendChild(e)}),n.appendChild(o),n.appendChild(i),n}let k=null;function L(e){if(!e)return;const t=(k&&k.isConnected||(k=document.createElement("div"),k.id="accessify-toolbar-v2-live",k.setAttribute("aria-live","polite"),k.setAttribute("aria-atomic","true"),k.className="accessify-toolbar-v2-live",document.body.appendChild(k)),k);t.textContent="",requestAnimationFrame(()=>{t.textContent=e,setTimeout(()=>{t.textContent=""},600)})}const A={normal:"contrastNormal",high:"contrastHigh",dark:"contrastDark"};function T(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.title=d("contrastTitle");const o=x(v.sun),i=document.createElement("span");function s(){const t=e().contrastMode;o.innerHTML=function(e){return"high"===e?v.contrast:"dark"===e?v.moon:v.sun}(t),i.textContent=d(A[t]||"contrastNormal"),function(e,t){const n=d(A[t]||"contrastNormal");e.setAttribute("aria-label",d("contrastAriaLabelCurrent",{mode:n}))}(n,t)}return n.appendChild(o),n.appendChild(i),n.addEventListener("click",()=>{t(),s();const n=d(A[e().contrastMode]||"contrastNormal");L(d("announceContrast",{mode:n}))}),s(),{section:w("sectionContrast",n),update:s,refreshLabels:function(){n.title=d("contrastTitle"),s()}}}function E(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.setAttribute("aria-label",d("toggleFont")),n.title=d("fontTitle"),n.setAttribute("aria-pressed","false"),n.appendChild(function(){const e=document.createElement("span");return e.className="accessify-toolbar-v2-font-d-badge",e.setAttribute("aria-hidden","true"),e.textContent="D",e}());const o=document.createElement("span");function i(){const t="dyslexia"===e().fontType;o.textContent=d(t?"fontDyslexia":"fontDefault"),n.setAttribute("aria-pressed",t?"true":"false")}return n.appendChild(o),n.addEventListener("click",()=>{t(),i();L(d("announceFont",{state:d("dyslexia"===e().fontType?"on":"off")}))}),i(),{section:w("sectionFont",n),update:i,refreshLabels:function(){n.setAttribute("aria-label",d("toggleFont")),n.title=d("fontTitle"),i()}}}const z={none:"colorFilterNone",grayscale:"colorFilterGrayscale",invert:"colorFilterInvert"};function S(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.title=d("colorAdjustmentsTitle");const o=x(v.palette),i=document.createElement("span");function s(){const t=e().colorFilter||"none";i.textContent=d(z[t]||"colorFilterNone"),function(e,t){const n=d(z[t]||"colorFilterNone");e.setAttribute("aria-label",d("colorFilterAriaLabelCurrent",{mode:n}))}(n,t)}return n.appendChild(o),n.appendChild(i),n.addEventListener("click",()=>{t(),s();const n=d(z[e().colorFilter]||"colorFilterNone");L(d("announceColorFilter",{mode:n}))}),s(),{section:w("sectionColorAdjustments",n),update:s,refreshLabels:function(){n.title=d("colorAdjustmentsTitle"),s()}}}const N=[{id:"textSize",labelKey:"controlTextSize",defaultVisible:!0,customizable:!0,create:(e,t)=>function(e,t,n){const o=document.createElement("button");o.type="button",o.className="accessify-toolbar-v2-btn",o.setAttribute("aria-label",d("decreaseTextSize")),o.title=d("decreaseTextSize"),o.appendChild(x(v.typeSmall));const i=document.createElement("span");i.className="accessify-toolbar-v2-text-a",i.textContent="A",i.style.fontSize="0.75rem",i.style.fontWeight="700",o.appendChild(i);const s=document.createElement("span");s.className="accessify-toolbar-v2-value",s.setAttribute("aria-live","polite");const r=document.createElement("button");r.type="button",r.className="accessify-toolbar-v2-btn",r.setAttribute("aria-label",d("increaseTextSize")),r.title=d("increaseTextSize"),r.appendChild(x(v.typeLarge));const a=document.createElement("span");function l(){const t=e().textSize;s.textContent=t+"%",o.disabled=t<=80,r.disabled=t>=200}a.className="accessify-toolbar-v2-text-a",a.textContent="A",a.style.fontSize="1rem",a.style.fontWeight="700",r.appendChild(a),o.addEventListener("click",()=>{t(),l()}),r.addEventListener("click",()=>{n(),l()});const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="8px",c.style.width="100%",o.style.flex="1",r.style.flex="1";const h=document.createElement("div");return h.style.display="flex",h.style.flexDirection="column",h.style.alignItems="center",h.style.padding="0 8px",h.appendChild(s),c.appendChild(o),c.appendChild(h),c.appendChild(r),l(),{section:w("sectionTextSize",c),update:l,refreshLabels:function(){o.setAttribute("aria-label",d("decreaseTextSize")),o.title=d("decreaseTextSize"),r.setAttribute("aria-label",d("increaseTextSize")),r.title=d("increaseTextSize")}}}(e,t.onDecrease,t.onIncrease)},{id:"contrast",labelKey:"controlContrast",defaultVisible:!0,customizable:!0,create:(e,t)=>T(e,t.onContrastCycle)},{id:"spacing",labelKey:"controlSpacing",defaultVisible:!0,customizable:!0,create:(e,t)=>function(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.setAttribute("aria-label",d("toggleSpacing")),n.title=d("spacingTitle"),n.setAttribute("aria-pressed","false"),n.appendChild(x(v.alignJustify));const o=document.createElement("span");function i(){const t="wide"===e().textSpacing;o.textContent=d(t?"spacingWide":"spacingNormal"),n.setAttribute("aria-pressed",t?"true":"false")}return n.appendChild(o),n.addEventListener("click",()=>{t(),i(),L(d("announceSpacing",{state:d("wide"===e().textSpacing?"spacingWide":"spacingNormal")}))}),i(),{section:w("sectionSpacing",n),update:i,refreshLabels:function(){n.setAttribute("aria-label",d("toggleSpacing")),n.title=d("spacingTitle"),i()}}}(e,t.onSpacingToggle)},{id:"font",labelKey:"controlFont",defaultVisible:!0,customizable:!0,create:(e,t)=>E(e,t.onFontToggle)},{id:"links",labelKey:"controlLinks",defaultVisible:!0,customizable:!0,create:(e,t)=>function(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.setAttribute("aria-label",d("toggleLinks")),n.title=d("linksTitle"),n.setAttribute("aria-pressed","false"),n.appendChild(x(v.link));const o=document.createElement("span");function i(){const t=e().highlightLinks;o.textContent=d(t?"on":"off"),n.setAttribute("aria-pressed",t?"true":"false")}return n.appendChild(o),n.addEventListener("click",()=>{t(),i(),L(d("announceLinks",{state:d(e().highlightLinks?"on":"off")}))}),i(),{section:w("sectionLinks",n),update:i,refreshLabels:function(){n.setAttribute("aria-label",d("toggleLinks")),n.title=d("linksTitle"),i()}}}(e,t.onLinksToggle)},{id:"cursor",labelKey:"controlCursor",defaultVisible:!0,customizable:!0,create:(e,t)=>function(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.setAttribute("aria-label",d("toggleCursor")),n.title=d("cursorTitle"),n.setAttribute("aria-pressed","false"),n.appendChild(x(v.mousePointer));const o=document.createElement("span");function i(){const t=e().highlightCursor;o.textContent=d(t?"on":"off"),n.setAttribute("aria-pressed",t?"true":"false")}return n.appendChild(o),n.addEventListener("click",()=>{t(),i(),L(d("announceCursor",{state:d(e().highlightCursor?"on":"off")}))}),i(),{section:w("sectionCursor",n),update:i,refreshLabels:function(){n.setAttribute("aria-label",d("toggleCursor")),n.title=d("cursorTitle"),i()}}}(e,t.onCursorToggle)},{id:"colorAdjustments",labelKey:"controlColorAdjustments",defaultVisible:!1,customizable:!0,create:(e,t)=>S(e,t.onColorFilterCycle)},{id:"reset",labelKey:"controlReset",defaultVisible:!0,customizable:!1,create:(e,t)=>function(e){const t=document.createElement("div");t.className="accessify-toolbar-v2-section accessify-toolbar-v2-reset",t.setAttribute("data-control-id","reset");const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-btn",n.setAttribute("aria-label",d("resetAriaLabel")),n.title=d("resetTitle"),n.appendChild(x(v.rotateCcw));const o=document.createElement("span");return o.textContent=d("resetLabel"),n.appendChild(o),t.appendChild(n),n.addEventListener("click",()=>{e(),L(d("announceReset"))}),{section:t,update:()=>{},refreshLabels:function(){n.setAttribute("aria-label",d("resetAriaLabel")),n.title=d("resetTitle"),o.textContent=d("resetLabel")}}}(t.onReset)},{id:"language",labelKey:"controlLanguage",defaultVisible:!1,customizable:!0,create:(e,t)=>function(e,t={}){const n=document.createElement("div");n.className="accessify-toolbar-v2-language-buttons",n.setAttribute("role","group"),n.setAttribute("aria-label",d("sectionLanguage"));const o=new Map;return function e(){n.innerHTML="";const i=h();for(const s of g()){const r=document.createElement("button");r.type="button",r.className="accessify-toolbar-v2-btn accessify-toolbar-v2-language-btn",r.setAttribute("aria-pressed",s===i?"true":"false"),r.textContent="en"===s?d("languageEn"):"he"===s?d("languageHe"):s.toUpperCase(),r.addEventListener("click",()=>{h()!==s&&(u(s),t.onLanguageChange&&t.onLanguageChange(s),e())}),o.set(s,r),n.appendChild(r)}}(),{section:w("sectionLanguage",n),update:function(){const e=h();o.forEach((t,n)=>{t.setAttribute("aria-pressed",n===e?"true":"false"),t.textContent="en"===n?d("languageEn"):"he"===n?d("languageHe"):n.toUpperCase()})}}}(0,t)}],_=new Map(N.map(e=>[e.id,e]));function F(e){return _.get(e)}function j(){const e={};for(const t of N)t.customizable&&(e[t.id]=t.defaultVisible);return e}function M(e,t,n){const o=_.get(e);return o?o.create(t,n):null}function V(e){const t=N.map(e=>e.id);return e&&0!==e.length?e.filter(e=>_.has(e)):t}class D{constructor(e={}){this.options=e,this.syncWithPageLanguage=!!e.syncWithPageLanguage,this.settings={...n},this.isOpen=!1,this.trigger=null,this.panel=null,this.panelBody=null,this.cursorHighlight=new f,this.controlUpdates=[],this.customizeSetVisible=null,this._boundKeydown=this._onKeydown.bind(this)}init(){s(),this.settings=function(){try{const e=localStorage.getItem(t);if(!e)return{...n};const o=JSON.parse(e);return{...n,...o}}catch{return{...n}}}(),this.settings.visibleControls={...j(),...this.settings.visibleControls};const e=p(document.documentElement.getAttribute("lang")),i=document.documentElement.getAttribute("dir");e?(u(e),this.settings.language=e,o(this.settings)):"rtl"===i?(u("he"),this.settings.language="he",o(this.settings)):this.settings.language?u(this.settings.language):(u("en"),this.settings.language="en"),this._initialLanguage=this.settings.language;const r=V(this.options.availableControls),a=()=>this.settings,l={textSize:{onDecrease:()=>{this.settings.textSize=Math.max(80,this.settings.textSize-10),this._persistAndApply()},onIncrease:()=>{this.settings.textSize=Math.min(200,this.settings.textSize+10),this._persistAndApply()}},contrast:{onContrastCycle:()=>{const e=["normal","high","dark"].indexOf(this.settings.contrastMode);this.settings.contrastMode=["normal","high","dark"][(e+1)%3],this._persistAndApply()}},spacing:{onSpacingToggle:()=>{this.settings.textSpacing="wide"===this.settings.textSpacing?"normal":"wide",this._persistAndApply()}},font:{onFontToggle:()=>{this.settings.fontType="dyslexia"===this.settings.fontType?"default":"dyslexia",this._persistAndApply()}},links:{onLinksToggle:()=>{this.settings.highlightLinks=!this.settings.highlightLinks,this._persistAndApply()}},cursor:{onCursorToggle:()=>{this.settings.highlightCursor=!this.settings.highlightCursor,this._persistAndApply(),this.cursorHighlight.setVisible(this.settings.highlightCursor)}},reset:{onReset:()=>{const e=this._initialLanguage||n.language;this.settings={...n,language:e,visibleControls:j()},u(e),this.syncWithPageLanguage&&(document.documentElement.setAttribute("lang",e),document.documentElement.setAttribute("dir",b(e))),this._persistAndApply(),this.cursorHighlight.setVisible(!1),this._applyVisibleControls(),this._refreshAllLabels(),this.controlUpdates.forEach(e=>e())}},language:{onLanguageChange:e=>{this.settings.language=e,o(this.settings),this.syncWithPageLanguage&&(document.documentElement.setAttribute("lang",e),document.documentElement.setAttribute("dir",b(e))),this._refreshAllLabels()}},colorAdjustments:{onColorFilterCycle:()=>{const e=["none","grayscale","invert"],t=e.indexOf(this.settings.colorFilter||"none");this.settings.colorFilter=e[(t+1)%e.length],this._persistAndApply()}}},g=function(e,t,n){const o=t(),i=document.createElement("div");i.className="accessify-toolbar-v2-customize-body";const s=new Map,r=new Map;let a=null,l=null;for(const t of e){const e=F(t);if(!e||!e.customizable)continue;const a=document.createElement("label");a.className="accessify-toolbar-v2-customize-label";const l=document.createElement("input");l.type="checkbox",l.className="accessify-toolbar-v2-customize-checkbox",l.setAttribute("data-aria-label-key","showControl"),l.setAttribute("data-aria-label-vars",JSON.stringify({label:e.labelKey})),l.setAttribute("aria-label",d("showControl",{label:d(e.labelKey)})),l.checked=!1!==o[t],s.set(t,l);const c=document.createElement("span");c.className="accessify-toolbar-v2-customize-label-text",c.setAttribute("data-label-key",e.labelKey),c.textContent=d(e.labelKey),r.set(t,c),a.appendChild(l),a.appendChild(c),l.addEventListener("change",()=>{const e=!!l.checked;n(t,e)}),i.appendChild(a)}const c=document.createElement("div");c.className="accessify-toolbar-v2-section accessify-toolbar-v2-customize";const h=document.createElement("button");h.type="button",h.className="accessify-toolbar-v2-customize-header",h.setAttribute("aria-expanded","false"),h.setAttribute("aria-controls","accessify-toolbar-v2-customize-body"),h.setAttribute("aria-label",d("customizeHeader")),a=h;const u=document.createElement("span");u.className="accessify-toolbar-v2-customize-header-label",u.textContent=d("customizeHeader"),l=u;const g=x(v.chevronDown,"accessify-toolbar-v2-customize-chevron");return h.appendChild(u),h.appendChild(g),i.id="accessify-toolbar-v2-customize-body",i.hidden=!0,h.addEventListener("click",()=>{const e=!("true"===h.getAttribute("aria-expanded"));h.setAttribute("aria-expanded",String(e)),i.hidden=!e,c.classList.toggle("accessify-toolbar-v2-customize-open",e)}),c.appendChild(h),c.appendChild(i),{section:c,setVisible:(e,t)=>{const n=s.get(e);n&&(n.checked=t)},refreshLabels:function(){a&&a.setAttribute("aria-label",d("customizeHeader")),l&&(l.textContent=d("customizeHeader")),r.forEach((e,t)=>{const n=F(t);n&&(e.textContent=d(n.labelKey))}),s.forEach((e,t)=>{const n=F(t);n&&e.setAttribute("aria-label",d("showControl",{label:d(n.labelKey)}))})}}}(r,()=>this.settings.visibleControls||{},(e,t)=>{this.settings.visibleControls||(this.settings.visibleControls={}),this.settings.visibleControls[e]=t,o(this.settings),this._applyVisibleControls()});this.customizeSetVisible=g.setVisible;const f=[g.section],m=[],y=[];for(const e of r){if(!F(e))continue;const t=M(e,a,l[e]||{});t&&(t.section.setAttribute("data-control-id",e),f.push(t.section),t.update&&m.push(t.update),t.refreshLabels&&y.push(t.refreshLabels))}this.controlUpdates=m,this._refreshLabelFns=y,this._customizeRefreshLabels=g.refreshLabels,this.trigger=function(e,t){const n=document.createElement("button");n.type="button",n.className="accessify-toolbar-v2-trigger",n.setAttribute("aria-label",d("triggerAriaLabel")),n.title=d("triggerTitle"),n.setAttribute("aria-expanded","false");const o=document.createElement("img");o.src="assets/accessify-icon.png",o.alt="",o.className="accessify-toolbar-v2-trigger-icon-img",o.setAttribute("aria-hidden","true");const i=x(v.accessibility);return i.classList.add("accessify-toolbar-v2-trigger-fallback"),o.onerror=()=>{o.parentNode===n&&n.removeChild(o)},n.appendChild(o),n.appendChild(i),n.addEventListener("click",()=>{e(),n.setAttribute("aria-expanded",String(t()))}),{element:n,setExpanded(e){n.setAttribute("aria-expanded",String(e))},refreshLabels(){n.setAttribute("aria-label",d("triggerAriaLabel")),n.title=d("triggerTitle")}}}(()=>this.toggle(),()=>this.isOpen),this._updateTriggerDir();const w=function(e,t){const n=document.createElement("div");n.className="accessify-toolbar-v2-panel",n.setAttribute("role","dialog"),n.setAttribute("aria-labelledby","accessify-toolbar-v2-dialog-title"),n.setAttribute("aria-modal","true");const o=C(t),i=o.element,s=i.querySelector(".accessify-toolbar-v2-header-title-text");s&&(s.id="accessify-toolbar-v2-dialog-title"),n.appendChild(i);const r=document.createElement("div");return r.className="accessify-toolbar-v2-panel-body",e.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&r.appendChild(e)}),n.appendChild(r),{panel:n,refreshHeaderLabels:o.refreshLabels}}(f,()=>this.close());var k;this.panel=w.panel,this._refreshHeaderLabels=w.refreshHeaderLabels,this.panelBody=this.panel.querySelector(".accessify-toolbar-v2-panel-body"),this._unsubscribeLanguage=(k=()=>this._refreshAllLabels(),c.push(k),()=>{const e=c.indexOf(k);-1!==e&&c.splice(e,1)});const L=document.createElement("div");for(L.id="accessify-toolbar-v2-content-wrapper";document.body.firstChild;)L.appendChild(document.body.firstChild);document.body.appendChild(L),document.body.appendChild(this.trigger.element),this.panel.style.display="none",document.body.appendChild(this.panel),this._contentWrapper=L,this._applyVisibleControls(),this._applySettingsToDocument(),this.cursorHighlight.mount(),this.cursorHighlight.setVisible(this.settings.highlightCursor),this._refreshAllLabels(),this.syncWithPageLanguage&&(this._langObserver=new MutationObserver(e=>{for(const t of e)if("lang"===t.attributeName||"dir"===t.attributeName){const e=p(document.documentElement.getAttribute("lang"));e&&e!==h()&&(u(e),this.settings.language=e,o(this.settings),this._refreshAllLabels());break}}),this._langObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["lang","dir"]})),document.addEventListener("keydown",this._boundKeydown)}_updateTriggerDir(){if(this.trigger&&this.trigger.element){const e="he"===h()?"rtl":"ltr";this.trigger.element.setAttribute("dir",e)}}_refreshAllLabels(){const e=h();this.panel&&(this.panel.setAttribute("dir","he"===e?"rtl":"ltr"),this.panel.setAttribute("lang",e)),this._updateTriggerDir(),this.trigger&&this.trigger.refreshLabels&&this.trigger.refreshLabels(),this._refreshHeaderLabels&&this._refreshHeaderLabels(),this._customizeRefreshLabels&&this._customizeRefreshLabels(),this.panel&&this.panel.querySelectorAll("[data-section-label-key]").forEach(e=>{const t=e.getAttribute("data-section-label-key");t&&(e.textContent=d(t))}),(this._refreshLabelFns||[]).forEach(e=>e()),this.controlUpdates.forEach(e=>e())}_applyVisibleControls(){const e=this.settings.visibleControls||{};if(this.panelBody&&(this.panelBody.querySelectorAll("[data-control-id]").forEach(t=>{const n=t.getAttribute("data-control-id"),o=n?F(n):null,i=o&&(!o.customizable||!1!==e[n]);t.style.display=i?"":"none"}),this.customizeSetVisible))for(const t of Object.keys(e))this.customizeSetVisible(t,!1!==e[t])}_applySettingsToDocument(){document.documentElement.style.fontSize=this.settings.textSize+"%";const e=document.body,t=this._contentWrapper;t?(t.classList.remove("contrast-normal","contrast-high","contrast-dark"),t.classList.add("contrast-"+(this.settings.contrastMode||"normal"))):(e.classList.remove("contrast-normal","contrast-high","contrast-dark"),e.classList.add("contrast-"+(this.settings.contrastMode||"normal"))),"wide"===this.settings.textSpacing?e.classList.add("text-spacing-wide"):e.classList.remove("text-spacing-wide"),"dyslexia"===this.settings.fontType?e.classList.add("font-dyslexia"):e.classList.remove("font-dyslexia"),this.settings.highlightLinks?e.classList.add("highlight-links"):e.classList.remove("highlight-links"),this.settings.highlightCursor?e.classList.add("highlight-cursor"):e.classList.remove("highlight-cursor");const n=t||e,o=["none","grayscale","invert"].includes(this.settings.colorFilter)?this.settings.colorFilter:"none";n.classList.remove("color-filter-none","color-filter-grayscale","color-filter-invert"),n.classList.add("color-filter-"+o)}_persistAndApply(){const e=window.scrollX??document.documentElement.scrollLeft,t=window.scrollY??document.documentElement.scrollTop;o(this.settings),this._applySettingsToDocument(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo(e,t)})})}_onKeydown(e){"Escape"===e.key&&this.isOpen&&(e.preventDefault(),this.close())}open(){this.isOpen||(this.isOpen=!0,this.panel.style.display="",this.trigger.setExpanded(!0))}close(){this.isOpen&&(this.isOpen=!1,this.panel.style.display="none",this.trigger.setExpanded(!1))}toggle(){this.isOpen?this.close():this.open()}destroy(){if(this._unsubscribeLanguage&&this._unsubscribeLanguage(),this._langObserver&&(this._langObserver.disconnect(),this._langObserver=null),document.removeEventListener("keydown",this._boundKeydown),this.trigger&&this.trigger.element.parentNode&&this.trigger.element.parentNode.removeChild(this.trigger.element),this.panel&&this.panel.parentNode&&this.panel.parentNode.removeChild(this.panel),this.cursorHighlight.unmount(),document.documentElement.style.fontSize="",document.body.classList.remove("text-spacing-wide","font-dyslexia","highlight-links","highlight-cursor","color-filter-none","color-filter-grayscale","color-filter-invert"),this._contentWrapper&&this._contentWrapper.parentNode){const e=this._contentWrapper.parentNode;for(;this._contentWrapper.firstChild;)e.insertBefore(this._contentWrapper.firstChild,this._contentWrapper);e.removeChild(this._contentWrapper)}}getSettings(){return{...this.settings}}}const H={ToolbarV2:D};"undefined"!=typeof window&&(window.Accessify=H),e.ToolbarV2=D,e.default=H,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=accessify.min.js.map
